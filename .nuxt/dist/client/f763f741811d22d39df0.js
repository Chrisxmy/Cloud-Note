(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{194:function(e,t,r){var content=r(217);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(17).default)("4c851083",content,!0,{sourceMap:!1})},195:function(e,t,r){var content=r(223);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(17).default)("30371855",content,!0,{sourceMap:!1})},196:function(e,t,r){"use strict";r(36),r(13);t.a={methods:{dispatch:function(e,t,r){for(var n=this.$parent||this.$root,o=n.$options.name;n&&(!o||o!==e);)(n=n.$parent)&&(o=n.$options.name);n&&n.$emit.apply(n,[t].concat(r))},broadcast:function(e,t,r){(function e(t,r,n){this.$children.forEach(function(o){o.$options.name===t?o.$emit.apply(o,[r].concat(n)):e.apply(o,[t,r].concat([n]))})}).call(this,e,t,r)}}}},216:function(e,t,r){"use strict";var n=r(194);r.n(n).a},217:function(e,t,r){(e.exports=r(16)(!1)).push([e.i,".m-input_wrapper{height:30px;display:flex;width:100%}.m-input{height:30px;width:100%;border-radius:4px;border:1px solid #ccc;padding-left:20px;transition:border .4s}.m-input-left-radius{border-radius:4px 0 0 4px;border-right:none}.m-input-right-radius{border-radius:0 4px 4px 0}.m-input:focus{border:1px solid #7568f3}.m-input-button{background:#7568f3;color:#fff;font-size:12px;height:30px;line-height:30px;text-align:center;border-radius:0 4px 4px 0;width:100px;cursor:pointer}",""])},222:function(e,t,r){"use strict";var n=r(195);r.n(n).a},223:function(e,t,r){(e.exports=r(16)(!1)).push([e.i,'.m-form-item{height:50px}.m-form-item>.label{height:30px;line-height:30px;margin-right:10px;text-align:right;width:80px}.m-form-item__message{font-size:12px;color:red}.m-form-item__label-required:before{content:"* ";color:red}',""])},224:function(e,t,r){"use strict";var n=r(196),o=r(243),l=r.n(o),d={name:"mFormItem",mixins:[n.a],inject:["form"],provide:function(){return{mFormItem:this}},props:{label:{type:String,default:""},prop:{type:String}},data:function(){return{isRequired:"",validateState:"",validateMessage:""}},computed:{fieldValue:function(){return this.form.model[this.prop]}},mounted:function(){this.prop&&(this.dispatch("mForm","on-form-item-add",this),this.initialValue=this.fieldValue,this.setRules())},methods:{getRules:function(){var e=this.form.rules;return e=e?e[this.prop]:[],[].concat(e||[])},setRules:function(){var e=this,t=this.getRules();t.length&&t.every(function(t){e.isRequired=t.required}),this.$on("on-form-blur",this.onFieldBlur),this.$on("on-form-change",this.onFieldChange)},getFilteredRule:function(e){return this.getRules().filter(function(t){return!t.trigger||-1!==t.trigger.indexOf(e)})},validate:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.getFilteredRule(e);if(!n||0===n.length)return!0;this.validateState="validating";var o={};o[this.prop]=n;var d=new l.a(o),m={};m[this.prop]=this.fieldValue,d.validate(m,{firstFields:!0},function(e){t.validateState=e?"error":"success",t.validateMessage=e?e[0].message:"",r(t.validateMessage)})},onFieldBlur:function(){this.validate("blur")},onFieldChange:function(){this.validate("change")},resetField:function(){this.validateState="",this.validateMessage="",this.form.model[this.prop]=this.initialValue}},beforeDestroy:function(){this.dispatch("mForm","on-form-item-remove",this)}},m=(r(222),r(20)),component=Object(m.a)(d,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"m-form-item"},[e.label?r("label",{staticClass:"label",class:{"m-form-item__label-required":e.isRequired}},[e._v(e._s(e.label))]):e._e(),e._v(" "),[e._t("default"),e._v(" "),"error"===e.validateState?r("span",{staticClass:"m-form-item__message"},[e._v(e._s(e.validateMessage))]):e._e()]],2)},[],!1,null,null,null);t.a=component.exports},225:function(e,t,r){"use strict";r(13);var n={name:"mForm",provide:function(){return{form:this}},props:{model:{type:Object},rules:{type:Object}},data:function(){return{fields:[]}},methods:{resetFields:function(){this.fields.forEach(function(e){e.resetField()})},validate:function(e){var t=this;return new Promise(function(r){var n=!0,o=0;t.fields.forEach(function(l){l.validate("",function(l){l&&(n=!1),++o===t.fields.length&&(r(n),"function"==typeof e&&e(n))})})})}},created:function(){var e=this;this.$on("on-form-item-add",function(t){t&&e.fields.push(t),console.log(e.fields)}),this.$on("on-form-item-remove",function(t){t.prop&&e.fields.splice(e.fields.indexOf(t),1)})}},o=r(20),component=Object(o.a)(n,function(){var e=this.$createElement;return(this._self._c||e)("form",{staticClass:"m-form"},[this._t("default")],2)},[],!1,null,null,null);t.a=component.exports},227:function(e,t,r){"use strict";var n={name:"mInput",mixins:[r(196).a],inject:{mFormItem:{default:""}},props:{value:{type:String,default:""},placeholder:{type:String,default:""}},data:function(){return{currentValue:"",append:!1}},created:function(){this.currentValue=this.value},mounted:function(){this.$slots.append&&(this.append=!0)},computed:{validateState:function(){return this.mFormItem.validateState}},watch:{value:function(e){this.currentValue=e}},methods:{handleInput:function(e){var t=event.target.value;this.currentValue=t,this.$emit("input",t),this.dispatch("mFormItem","on-form-change",t)},handleBlur:function(){this.dispatch("mFormItem","on-form-blur",this.currentValue)}}},o=(r(216),r(20)),component=Object(o.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"m-input_wrapper"},[r("input",{ref:"input",staticClass:"m-input",class:[{error:"error"===e.validateState},{"m-input-left-radius":e.append}],attrs:{placeholder:e.placeholder},domProps:{value:e.currentValue},on:{input:e.handleInput,blur:e.handleBlur}}),e._v(" "),e.append?r("p",{staticClass:"m-input-button"},[e._t("append")],2):e._e()])},[],!1,null,null,null);t.a=component.exports},366:function(e,t,r){"use strict";r.r(t);r(35);var n=r(3),input=r(227),o=r(225),l=r(224),d={components:{mInput:input.a,mForm:o.a,mFormItem:l.a},data:function(){return{repeatPassword:"",formValidate:{username:"",password:"",identifyingCode:"",email:""},ruleValidate:{identifyingCode:[{required:!0,message:"验证码不能为空",trigger:"blur"}],username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}]}}},methods:{submitForm:function(){var e=this;this.$refs.form.validate(function(t){t&&e.signUp()})},sendEmail:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formValidate.email){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.$axios.post("/emailValidate",{email:this.formValidate.email});case 4:0===(t=e.sent).code?this.$message.success("邮件发送成功"):this.$message.error(t.message||"发送验证码失败");case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),signUp:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.post("/register",this.formValidate);case 2:0===(t=e.sent).code?(this.$message.success("注册成功"),this.$store.commit("setUser",t.data),this.$router.push("/book")):this.$message.error(t.message||"注册失败");case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},m=r(20),component=Object(m.a)(d,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h4",[e._v("Sign up Note")]),e._v(" "),r("m-form",{ref:"form",attrs:{model:e.formValidate,rules:e.ruleValidate}},[r("m-form-item",{attrs:{prop:"email"}},[r("m-input",{attrs:{type:"text",placeholder:"邮箱"},model:{value:e.formValidate.email,callback:function(t){e.$set(e.formValidate,"email",t)},expression:"formValidate.email"}})],1),e._v(" "),r("m-form-item",{attrs:{prop:"identifyingCode"}},[r("m-input",{attrs:{type:"text",placeholder:"邮箱验证码"},model:{value:e.formValidate.identifyingCode,callback:function(t){e.$set(e.formValidate,"identifyingCode",t)},expression:"formValidate.identifyingCode"}},[r("div",{attrs:{slot:"append"},on:{click:e.sendEmail},slot:"append"},[e._v("发送验证码")])])],1),e._v(" "),r("m-form-item",{attrs:{prop:"username"}},[r("m-input",{attrs:{type:"text",placeholder:"用户名"},model:{value:e.formValidate.username,callback:function(t){e.$set(e.formValidate,"username",t)},expression:"formValidate.username"}})],1),e._v(" "),r("m-form-item",{attrs:{prop:"password"}},[r("m-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.formValidate.password,callback:function(t){e.$set(e.formValidate,"password",t)},expression:"formValidate.password"}})],1),e._v(" "),r("m-form-item",[r("m-input",{attrs:{type:"password",placeholder:"重复密码"},model:{value:e.repeatPassword,callback:function(t){e.repeatPassword=t},expression:"repeatPassword"}})],1)],1),e._v(" "),r("div",{staticClass:"reset-password"},[r("nuxt-link",{attrs:{to:"/retrievePassword",tag:"span"}},[e._v("ForgetPassword？")])],1),e._v(" "),r("span",{staticClass:"m-button",on:{click:e.submitForm}},[e._v("Sign up")]),e._v(" "),r("p",{staticClass:"sign-up"},[r("nuxt-link",{attrs:{to:"/login",tag:"span"}},[e._v("back to login")])],1)],1)},[],!1,null,null,null);t.default=component.exports}}]);